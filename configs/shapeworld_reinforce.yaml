# Configuration for training a REINFORCE speaker on ShapeWorld
# Note: Literal listeners (L0) are automatically trained if not found
# REINFORCE uses policy gradients with multinomial sampling

# Dataset configuration
dataset:
  name: shapeworld
  n_examples: 1000
  n_images: 3
  data_type: reference
  img_type: single
  generalization: null  # or: new_color, new_shape, new_combo

# Training configuration
training:
  model_type: amortized
  batch_size: 32
  epochs: 100
  learning_rate: null  # auto-set based on model type
  cuda: true
  debug: false
  
  # REINFORCE speaker specific
  activation: multinomial  # policy gradient sampling
  penalty: length
  lmbd: 0.01
  tau: 1.0
  
  # Random seed for reproducibility
  seed: 42
  
  # Literal listener (L0) pretraining config
  l0_epochs: 100
  l0_learning_rate: 0.0001
  l0_batch_size: 32

# Model architecture (applies to both L0 and REINFORCE speaker)
model:
  embedding_dim: 256
  hidden_size: 256
  vision_model: Conv4
  max_sequence_length: 10

